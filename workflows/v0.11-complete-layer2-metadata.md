---
TASK: Complete v0.11 Layer 2 Structured Metadata
AGENT: code-development-expert
PRIORITY: Critical (v0.11 release blocker)
ESTIMATED TIME: 14-22 hours per jurisdiction (51 total)
TIMELINE: 4-6 weeks for all 51 jurisdictions
---

# v0.11 Layer 2 Completion Task

## Objective

Parse existing statutory text files (Layer 1) into structured JSON metadata (Layer 2) to enable Map comparison metrics and advanced Wiki search.

**What This Enables**:
- Transparency Map: Color-coded comparison of response times, fees, exemptions
- Transparency Wiki: Filter by response time, search by fee structure
- Platform: Structured data for Supabase integration

**What This Does NOT Include** (deferred to v0.12):
- ❌ Agency contact databases
- ❌ Custom training examples
- ❌ FOIA request templates

## Current State

**You already have**:
- ✅ 51 statutory text files (Layer 1) - COMPLETE
- ✅ 52 process maps (Layer 3) - COMPLETE
- ⚠️ 51 empty `jurisdiction-data.json` files (Layer 2) - TEMPLATES ONLY

**Example of current state** (`data/states/maine/jurisdiction-data.json`):
```json
{"jurisdiction":"","transparency_law":"","agencies":[]}
```

**Goal state**:
```json
{
  "jurisdiction": "Maine",
  "transparency_law": {
    "name": "Freedom of Access Act",
    "statute_citation": "1 M.R.S. §§ 401-410",
    "response_requirements": { /* parsed data */ },
    "fee_structure": { /* parsed data */ },
    "exemptions": [ /* parsed data */ ],
    "appeal_process": { /* parsed data */ }
  },
  "agencies": []  // Leave empty for v0.12
}
```

---

## Input Files

**Source Directory**: `consolidated-transparency-data/statutory-text-files/`

**Files** (51 total):
- `ALABAMA_transparency_law-v0.11.txt`
- `ALASKA_transparency_law-v0.11.txt`
- `ARIZONA_transparency_law-v0.11.txt`
- ... (all 51 jurisdictions)
- `FEDERAL_FOIA_transparency_law-v0.11.txt`

**File Format**: Plain text with full statute text
**Source Verification**: All from official .gov sites (v0.11 verified)

---

## Output Files

**Target Directory**: `data/states/{state-name}/`

**File**: `jurisdiction-data.json`

**Required Fields** (from schema):

```json
{
  "jurisdiction": "Maine",
  "transparency_law": {
    "name": "Freedom of Access Act",
    "statute_citation": "1 M.R.S. §§ 401-410",
    "effective_date": "1976-01-01",
    "last_amended": "2023-06-15",

    "response_requirements": {
      "initial_response_time": 5,
      "initial_response_unit": "business_days",  // CRITICAL: business_days or calendar_days
      "final_response_time": 30,
      "final_response_unit": "business_days",
      "extension_allowed": true,
      "extension_max_days": 10
    },

    "fee_structure": {
      "search_fee": "actual cost",
      "search_fee_statutory_cite": "1 M.R.S. § 408-A",
      "copy_fee_per_page": 0.10,
      "copy_fee_cite": "1 M.R.S. § 408-A(1)",
      "electronic_fee": "none",
      "fee_waiver_available": true,
      "fee_waiver_criteria": "public interest"
    },

    "exemptions": [
      {
        "category": "Personal Privacy",
        "citation": "1 M.R.S. § 402(3)(A)",
        "description": "Personnel and medical files",
        "scope": "narrow"  // narrow, moderate, or broad
      }
    ],

    "appeal_process": {
      "first_level": "Agency head review",
      "first_level_deadline_days": 5,
      "first_level_cite": "1 M.R.S. § 409(1)",
      "second_level": "Superior Court",
      "second_level_deadline_days": 30,
      "attorney_fees_recoverable": true
    },

    "validation_metadata": {
      "parsed_date": "2025-10-02",
      "confidence_level": "high",  // high, medium, or low
      "source_url": "https://legislature.maine.gov/statutes/1/title1ch13sec0.html",
      "notes": ""
    }
  },
  "agencies": []  // LEAVE EMPTY - populated in v0.12
}
```

---

## Parsing Approach

### Option 1: AI-Assisted Parsing (RECOMMENDED)

**Tool**: GPT-4 with structured extraction prompts

**Process**:
1. Load statutory text file
2. Send to GPT-4 with extraction prompt
3. Validate output against JSON schema
4. Human verify 20% sample
5. Commit to repo

**GPT-4 Prompt Template**:

```
You are a legal document parser extracting structured data from transparency law statutes.

STATUTE TEXT:
{full_statute_text}

EXTRACT THE FOLLOWING (return as JSON):

1. Law name and citation
   - Official name of the law
   - Full statutory citation (e.g., "1 M.R.S. §§ 401-410")

2. Response requirements
   - Initial response deadline (number + unit)
   - CRITICAL: Specify "business_days" or "calendar_days"
   - Final response deadline
   - Extension provisions (allowed? max days?)

3. Fee structure
   - Search fees (quote exact statutory language)
   - Copy fees per page (numeric value)
   - Electronic document fees
   - Fee waiver availability and criteria
   - Include statutory citations for each fee type

4. Exemptions
   - List major exemption categories
   - Provide statutory citation for each
   - Brief description
   - Scope: narrow/moderate/broad

5. Appeal process
   - First level (usually agency head)
   - Deadline for first level appeal
   - Second level (usually court)
   - Attorney fee recovery provisions

RULES:
- Quote exact statutory citations
- Use "business_days" or "calendar_days" explicitly
- Include section numbers (e.g., § 408-A, not just "408")
- If uncertain, use "unknown" and set confidence_level to "medium"
- Be conservative: only extract what you can verify from the text

RETURN: Valid JSON matching the structure shown above
```

### Option 2: Manual Extraction

If AI parsing fails or produces low confidence:
1. Read statutory text manually
2. Fill in template JSON file
3. Validate against schema
4. Commit

---

## Processing Order

### Batch 1: High Priority (Week 1)
**Jurisdictions**: Federal + CA, FL, IL, NY, TX (6 total)
**Why**: Covers ~40% of US population, validates approach

**Deliverable**: 6 completed `jurisdiction-data.json` files

### Batch 2: Medium Priority (Week 2-3)
**Jurisdictions**: 15 additional major states
**Why**: Covers ~70% of US population

**Deliverable**: 21 total completed files

### Batch 3: Remaining States (Week 4-5)
**Jurisdictions**: 30 remaining states + DC
**Why**: Complete national coverage

**Deliverable**: 51 total completed files

### Batch 4: Validation & QA (Week 6)
**Activities**:
- Human review 20% sample
- Fix flagged items
- Final schema validation
- Prepare for v0.11 release

---

## Critical Parsing Rules

### Rule 1: Business Days vs Calendar Days

**This is CRITICAL for Map comparisons**

```json
// CORRECT
"initial_response_time": 5,
"initial_response_unit": "business_days"

// INCORRECT
"initial_response_time": 5,
"initial_response_unit": "days"  // ❌ Too ambiguous
```

**How to determine**:
- Look for: "business days", "working days", "weekdays"
- Default to "calendar_days" if statute says just "days"
- Flag as "uncertain" if unclear

### Rule 2: Fee Structure Precision

**Quote exact statutory language for fees**

```json
// CORRECT
"search_fee": "actual cost not to exceed $25/hour"
"copy_fee_per_page": 0.10

// INCORRECT
"search_fee": "varies"  // ❌ Too vague
"copy_fee_per_page": "10 cents"  // ❌ Use numeric
```

### Rule 3: Exemption Categorization

**Use consistent category names across jurisdictions**

Standard categories:
- Personal Privacy
- Law Enforcement
- Trade Secrets
- Deliberative Process
- Security
- Attorney-Client Privilege
- Medical Records
- Ongoing Investigation

### Rule 4: Citation Format

**Always include section symbols and numbers**

```json
// CORRECT
"citation": "1 M.R.S. § 402(3)(A)"

// INCORRECT
"citation": "Section 402"  // ❌ Missing statute reference
"citation": "1 MRS 402"    // ❌ Missing § symbol
```

---

## Quality Validation

### Automated Checks (100% of files)

```python
import json
import jsonschema

# Load schema
with open('templates/json/STANDARD_JURISDICTION_TEMPLATE_template-v0.11.json') as f:
    schema = json.load(f)

# Validate each file
for state_file in state_files:
    with open(state_file) as f:
        data = json.load(f)

    try:
        jsonschema.validate(data, schema)
        print(f"✅ {state_file}: Valid")
    except jsonschema.ValidationError as e:
        print(f"❌ {state_file}: {e.message}")
```

**Required checks**:
- [x] JSON schema valid
- [x] All required fields populated
- [x] Response time units specified
- [x] Fee citations included
- [x] Exemptions categorized
- [x] Dates in ISO 8601 format

### Manual Verification (20% sample)

**Sample selection**: Random 10 jurisdictions

**Verification checklist**:
- [ ] Response times match statute text
- [ ] Fee structure quotes match exactly
- [ ] Exemptions correctly categorized
- [ ] Citations verified against source
- [ ] Business/calendar days correct

---

## Confidence Levels

Set `validation_metadata.confidence_level`:

**High**:
- All fields extracted with certainty
- Response times clearly specified
- Fee structure unambiguous
- Citations verified

**Medium**:
- Some ambiguity in response times
- Complex fee structures
- Uncertain exemption categories
- Human review recommended

**Low**:
- Significant uncertainty
- Contradictory statute language
- Missing key information
- Requires legal expert review

**Action for Medium/Low**:
- Flag in tracking table
- Add detailed notes
- Schedule human review

---

## Edge Cases

### Case 1: "Reasonable Time" Response Deadlines

Some statutes say "respond within a reasonable time" without specifying days.

**Solution**:
```json
"initial_response_time": -1,  // Special code for "reasonable time"
"initial_response_unit": "variable",
"notes": "Statute specifies 'reasonable time' without numeric deadline"
```

### Case 2: Complex Fee Structures

"First 100 pages free, then $0.10/page, maximum $50"

**Solution**:
```json
"copy_fee_per_page": 0.10,  // Most common rate
"fee_structure_notes": "First 100 pages free, then $0.10/page, maximum $50 total",
"copy_fee_cite": "1 M.R.S. § 408-A(1)"
```

### Case 3: Multiple Exemption Subcategories

Privacy exemptions with 15 subcategories

**Solution**:
```json
{
  "category": "Personal Privacy",
  "citation": "1 M.R.S. § 402(3)",
  "description": "Personnel files, medical records, welfare records, and other personal information",
  "subcategories": "See § 402(3)(A-O) for 15 specific privacy exemptions"
}
```

---

## Deliverables Per Jurisdiction

1. **Populated JSON file**: `data/states/{state}/jurisdiction-data.json`
2. **Git commit**: Clear message indicating jurisdiction + confidence level
3. **Verification note** (if flagged): Document in tracking table

**Example commit message**:
```
feat(maine): Add Layer 2 structured metadata (high confidence)

Parsed Maine Freedom of Access Act (1 M.R.S. §§ 401-410)
- Response times: 5 business days initial, 30 business days final
- Fees: $0.10/page copy fee, public interest waiver available
- 8 major exemption categories identified
- Appeal process: Agency head → Superior Court

Confidence: HIGH
All fields verified against official statute text
```

---

## Success Criteria

**Quantitative**:
- [ ] 51/51 jurisdictions have populated `transparency_law` objects
- [ ] 100% JSON schema compliance
- [ ] 95%+ high confidence extractions

**Qualitative**:
- [ ] Map can display response time comparisons
- [ ] Wiki can filter by fee structure
- [ ] Ready for Supabase integration
- [ ] No conflicting data across layers

---

## Agent Execution Steps

### Step 1: Setup
```bash
cd /Volumes/HOLE-RAID-DRIVE/HOLE/Projects/us-transparency-laws-database
git checkout -b layer2-v0.11-completion
```

### Step 2: Process First Jurisdiction (Federal)
1. Read `consolidated-transparency-data/statutory-text-files/FEDERAL_FOIA_transparency_law-v0.11.txt`
2. Extract structured data (AI-assisted or manual)
3. Populate `data/federal/jurisdiction-data.json` (transparency_law section)
4. Validate against schema
5. Commit: `git commit -m "feat(federal): Add Layer 2 metadata"`

### Step 3: Repeat for Remaining 50 Jurisdictions

Process in batches:
- Batch 1: CA, FL, IL, NY, TX
- Batch 2: Next 15 states
- Batch 3: Remaining 30 + DC

### Step 4: Quality Validation
1. Run automated schema validation on all 51 files
2. Select 10 random jurisdictions for manual review
3. Fix any errors or low-confidence extractions
4. Update tracking table

### Step 5: Final Commit
```bash
git add -A
git commit -m "feat: Complete v0.11 Layer 2 structured metadata (51/51 jurisdictions)"
git push origin layer2-v0.11-completion
```

---

## What Happens After This Task

**v0.11 Release**:
- Map can display comparison metrics ✅
- Wiki can filter by response time/fees ✅
- Supabase schema populated with structured data ✅
- FOIA Generator works with basic AI Foundry agent ✅

**v0.12 Future Work** (NOT part of this task):
- Add agency contact databases
- Generate custom training examples
- Fine-tune FOIA Generator with examples

---

## Estimated Timeline

**With AI Assistance**:
- 30 minutes per jurisdiction (parsing)
- 10 minutes validation
- 10 minutes commit/documentation
- **Total**: ~50 minutes × 51 = **~42 hours** (1 week full-time)

**Conservative Estimate** (accounting for edge cases):
- **4-6 weeks** part-time work
- Can be parallelized across multiple contributors

**Deliverable**: Complete v0.11 Layer 2 by mid-November 2025 (assuming start early October)

---

## Ready to Launch?

This task is ready for a `code-development-expert` agent to execute:

```bash
# Launch agent with this workflow file
# Agent processes jurisdictions sequentially
# Agent commits after each jurisdiction
# Agent flags uncertain extractions for human review
```

**Next step**: Approve this plan and launch the agent task!
